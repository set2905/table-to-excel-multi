{"mappings":"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","sources":["src/tableToExcel.js","src/parser.js"],"sourcesContent":["import Parser from './parser';\r\nimport saveAs from 'file-saver';\r\nimport ExcelJS from 'exceljs';\r\n\r\nconst TableToExcel = (function (Parser) {\r\n\tlet methods = {};\r\n\r\n\tmethods.initWorkBook = function () {\r\n\t\tlet wb = new ExcelJS.Workbook();\r\n\t\treturn wb;\r\n\t};\r\n\r\n\tmethods.initSheet = function (wb, sheetName) {\r\n\t\tlet ws = wb.addWorksheet(sheetName);\r\n\t\treturn ws;\r\n\t};\r\n\r\n\tmethods.save = function (wb, fileName) {\r\n\t\twb.xlsx.writeBuffer().then(function (buffer) {\r\n\t\t\tsaveAs(new Blob([buffer], { type: 'application/octet-stream' }), fileName);\r\n\t\t});\r\n\t};\r\n\r\n\tmethods.tableToSheet = function (wb, table, opts) {\r\n\t\tlet ws = wb.getWorksheet(opts.sheet.name);\r\n\t\tif (ws === undefined) ws = this.initSheet(wb, opts.sheet.name);\r\n\t\tws = Parser.parseDomToTable(ws, table, opts);\r\n\t\treturn wb;\r\n\t};\r\n\r\n\tmethods.tableToBook = function (table, opts) {\r\n\t\tlet wb = this.initWorkBook();\r\n\t\twb = this.tableToSheet(wb, table, opts);\r\n\t\treturn wb;\r\n\t};\r\n\r\n\tmethods.convert = function (table, opts = {}) {\r\n\t\tlet defaultOpts = {\r\n\t\t\tname: 'export.xlsx',\r\n\t\t\tautoStyle: false,\r\n\t\t\tsheet: {\r\n\t\t\t\tname: 'Sheet 1',\r\n\t\t\t},\r\n\t\t};\r\n\t\topts = { ...defaultOpts, ...opts };\r\n\t\tlet wb = this.tableToBook(table, opts);\r\n\t\tthis.save(wb, opts.name);\r\n\t};\r\n\r\n\treturn methods;\r\n})(Parser);\r\n\r\nexport default TableToExcel;\r\nwindow.TableToExcel = TableToExcel;\r\n","const TTEParser = (function () {\r\n\tlet methods = {};\r\n\r\n\t/**\r\n\t * Parse HTML table to excel worksheet\r\n\t * @param {object} ws The worksheet object\r\n\t * @param {HTML entity} table The table to be converted to excel sheet\r\n\t */\r\n\tmethods.parseDomToTable = function (ws, table, opts) {\r\n\t\tlet startrow = ws.rowCount + 1;\r\n\t\tif(ws.rowCount === 1) startrow = 0;\r\n\t\tlet _r, _c, cs, rs, r, c;\r\n\t\tlet rows = [...table.rows];\r\n\t\tlet widths = table.getAttribute('data-cols-width');\r\n\t\tif (widths)\r\n\t\t\twidths = widths.split(',').map(function (item) {\r\n\t\t\t\treturn parseInt(item);\r\n\t\t\t});\r\n\t\tlet merges = [];\r\n\t\tfor (_r = 0; _r < rows.length; ++_r) {\r\n\t\t\tlet row = rows[_r];\r\n\t\t\tr = _r + 1 + startrow; // Actual excel row number\r\n\t\t\tc = 1; // Actual excel col number\r\n\t\t\tif (row.getAttribute('data-exclude') === 'true') {\r\n\t\t\t\trows.splice(_r, 1);\r\n\t\t\t\t_r--;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (row.getAttribute('data-height')) {\r\n\t\t\t\tlet exRow = ws.getRow(r);\r\n\t\t\t\texRow.height = parseFloat(row.getAttribute('data-height'));\r\n\t\t\t}\r\n\r\n\t\t\tlet tds = [...row.children];\r\n\t\t\tfor (_c = 0; _c < tds.length; ++_c) {\r\n\t\t\t\tlet td = tds[_c];\r\n\t\t\t\tif (td.getAttribute('data-exclude') === 'true') {\r\n\t\t\t\t\ttds.splice(_c, 1);\r\n\t\t\t\t\t_c--;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tfor (let _m = 0; _m < merges.length; ++_m) {\r\n\t\t\t\t\tvar m = merges[_m];\r\n\t\t\t\t\tif (m.s.c == c && m.s.r <= r && r <= m.e.r) {\r\n\t\t\t\t\t\tc = m.e.c + 1;\r\n\t\t\t\t\t\t_m = -1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tlet exCell = ws.getCell(getColumnAddress(c, r));\r\n\t\t\t\t// calculate merges\r\n\t\t\t\tcs = parseInt(td.getAttribute('colspan')) || 1;\r\n\t\t\t\trs = parseInt(td.getAttribute('rowspan')) || 1;\r\n\t\t\t\tif (cs > 1 || rs > 1) {\r\n\t\t\t\t\tmerges.push({\r\n\t\t\t\t\t\ts: { c: c, r: r },\r\n\t\t\t\t\t\te: { c: c + cs - 1, r: r + rs - 1 },\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tc += cs;\r\n\t\t\t\texCell.value = getValue(td);\r\n\t\t\t\tif (!opts.autoStyle) {\r\n\t\t\t\t\tlet styles = getStylesDataAttr(td);\r\n\t\t\t\t\texCell.font = styles.font || null;\r\n\t\t\t\t\texCell.alignment = styles.alignment || null;\r\n\t\t\t\t\texCell.border = styles.border || null;\r\n\t\t\t\t\texCell.fill = styles.fill || null;\r\n\t\t\t\t\texCell.numFmt = styles.numFmt || null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t//Setting column width\r\n\t\tif (widths)\r\n\t\t\twidths.forEach((width, _i) => {\r\n\t\t\t\t//у столбца будет максимальный width, в случае нескольких таблиц на листе\r\n\t\t\t\tif (!ws.columns[_i].width || ws.columns[_i].width < width) ws.columns[_i].width = width;\r\n\t\t\t});\r\n\t\tapplyMerges(ws, merges);\r\n\t\treturn ws;\r\n\t};\r\n\r\n\t/**\r\n\t * To apply merges on the sheet\r\n\t * @param {object} ws The worksheet object\r\n\t * @param {object[]} merges array of merges\r\n\t */\r\n\tlet applyMerges = function (ws, merges) {\r\n\t\tmerges.forEach((m) => {\r\n\t\t\tws.mergeCells(getExcelColumnName(m.s.c) + m.s.r + ':' + getExcelColumnName(m.e.c) + m.e.r);\r\n\t\t});\r\n\t};\r\n\r\n\t/**\r\n\t * Convert HTML to plain text\r\n\t */\r\n\tlet htmldecode = (function () {\r\n\t\tlet entities = [\r\n\t\t\t['nbsp', ' '],\r\n\t\t\t['middot', '·'],\r\n\t\t\t['quot', '\"'],\r\n\t\t\t['apos', \"'\"],\r\n\t\t\t['gt', '>'],\r\n\t\t\t['lt', '<'],\r\n\t\t\t['amp', '&'],\r\n\t\t].map(function (x) {\r\n\t\t\treturn [new RegExp('&' + x[0] + ';', 'g'), x[1]];\r\n\t\t});\r\n\t\treturn function htmldecode(str) {\r\n\t\t\tlet o = str\r\n\t\t\t\t.trim()\r\n\t\t\t\t.replace(/\\s+/g, ' ')\r\n\t\t\t\t.replace(/<\\s*[bB][rR]\\s*\\/?>/g, '\\n')\r\n\t\t\t\t.replace(/<[^>]*>/g, '');\r\n\t\t\tfor (let i = 0; i < entities.length; ++i) o = o.replace(entities[i][0], entities[i][1]);\r\n\t\t\treturn o;\r\n\t\t};\r\n\t})();\r\n\r\n\t/**\r\n\t * Takes a positive integer and returns the corresponding column name.\r\n\t * @param {number} num  The positive integer to convert to a column name.\r\n\t * @return {string}  The column name.\r\n\t */\r\n\tlet getExcelColumnName = function (num) {\r\n\t\tfor (var ret = '', a = 1, b = 26; (num -= a) >= 0; a = b, b *= 26) {\r\n\t\t\tret = String.fromCharCode(parseInt((num % b) / a) + 65) + ret;\r\n\t\t}\r\n\t\treturn ret;\r\n\t};\r\n\r\n\tlet getColumnAddress = function (col, row) {\r\n\t\treturn getExcelColumnName(col) + row;\r\n\t};\r\n\r\n\t/**\r\n\t * Checks the data type specified and conerts the value to it.\r\n\t * @param {HTML entity} td\r\n\t */\r\n\tlet getValue = function (td) {\r\n\t\tlet dataType = td.getAttribute('data-t');\r\n\t\tlet rawVal = htmldecode(td.innerHTML);\r\n\t\tif (dataType) {\r\n\t\t\tlet val;\r\n\t\t\tswitch (dataType) {\r\n\t\t\t\tcase 'n': //number\r\n\t\t\t\t\trawVal = rawVal.replace(/ /g, '').replace(',', '.');\r\n\t\t\t\t\tval = Number(rawVal);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'd': //date\r\n\t\t\t\t\tlet date = new Date(rawVal);\r\n\t\t\t\t\t// To fix the timezone issue\r\n\t\t\t\t\tval = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds()));\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'b': //boolean\r\n\t\t\t\t\tval = rawVal.toLowerCase() === 'true' ? true : rawVal.toLowerCase() === 'false' ? false : Boolean(parseInt(rawVal));\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tval = rawVal;\r\n\t\t\t}\r\n\t\t\treturn val;\r\n\t\t} else if (td.getAttribute('data-hyperlink')) {\r\n\t\t\treturn {\r\n\t\t\t\ttext: rawVal,\r\n\t\t\t\thyperlink: td.getAttribute('data-hyperlink'),\r\n\t\t\t};\r\n\t\t} else if (td.getAttribute('data-error')) {\r\n\t\t\treturn { error: td.getAttribute('data-error') };\r\n\t\t}\r\n\t\treturn rawVal;\r\n\t};\r\n\r\n\t/**\r\n\t * Prepares the style object for a cell using the data attributes\r\n\t * @param {HTML entity} td\r\n\t */\r\n\tlet getStylesDataAttr = function (td) {\r\n\t\t//Font attrs\r\n\t\tlet font = {};\r\n\t\tif (td.getAttribute('data-f-name')) font.name = td.getAttribute('data-f-name');\r\n\t\tif (td.getAttribute('data-f-sz')) font.size = td.getAttribute('data-f-sz');\r\n\t\tif (td.getAttribute('data-f-color')) font.color = { argb: td.getAttribute('data-f-color') };\r\n\t\tif (td.getAttribute('data-f-bold') === 'true') font.bold = true;\r\n\t\tif (td.getAttribute('data-f-italic') === 'true') font.italic = true;\r\n\t\tif (td.getAttribute('data-f-underline') === 'true') font.underline = true;\r\n\t\tif (td.getAttribute('data-f-strike') === 'true') font.strike = true;\r\n\r\n\t\t// Alignment attrs\r\n\t\tlet alignment = {};\r\n\t\tif (td.getAttribute('data-a-h')) alignment.horizontal = td.getAttribute('data-a-h');\r\n\t\tif (td.getAttribute('data-a-v')) alignment.vertical = td.getAttribute('data-a-v');\r\n\t\tif (td.getAttribute('data-a-wrap') === 'true') alignment.wrapText = true;\r\n\t\tif (td.getAttribute('data-a-text-rotation')) alignment.textRotation = td.getAttribute('data-a-text-rotation');\r\n\t\tif (td.getAttribute('data-a-indent')) alignment.indent = td.getAttribute('data-a-indent');\r\n\t\tif (td.getAttribute('data-a-rtl') === 'true') alignment.readingOrder = 'rtl';\r\n\r\n\t\t// Border attrs\r\n\t\tlet border = {\r\n\t\t\ttop: {},\r\n\t\t\tleft: {},\r\n\t\t\tbottom: {},\r\n\t\t\tright: {},\r\n\t\t};\r\n\r\n\t\tif (td.getAttribute('data-b-a-s')) {\r\n\t\t\tlet style = td.getAttribute('data-b-a-s');\r\n\t\t\tborder.top.style = style;\r\n\t\t\tborder.left.style = style;\r\n\t\t\tborder.bottom.style = style;\r\n\t\t\tborder.right.style = style;\r\n\t\t}\r\n\t\tif (td.getAttribute('data-b-a-c')) {\r\n\t\t\tlet color = { argb: td.getAttribute('data-b-a-c') };\r\n\t\t\tborder.top.color = color;\r\n\t\t\tborder.left.color = color;\r\n\t\t\tborder.bottom.color = color;\r\n\t\t\tborder.right.color = color;\r\n\t\t}\r\n\t\tif (td.getAttribute('data-b-t-s')) {\r\n\t\t\tborder.top.style = td.getAttribute('data-b-t-s');\r\n\t\t\tif (td.getAttribute('data-b-t-c')) border.top.color = { argb: td.getAttribute('data-b-t-c') };\r\n\t\t}\r\n\t\tif (td.getAttribute('data-b-l-s')) {\r\n\t\t\tborder.left.style = td.getAttribute('data-b-l-s');\r\n\t\t\tif (td.getAttribute('data-b-l-c')) border.left.color = { argb: td.getAttribute('data-b-t-c') };\r\n\t\t}\r\n\t\tif (td.getAttribute('data-b-b-s')) {\r\n\t\t\tborder.bottom.style = td.getAttribute('data-b-b-s');\r\n\t\t\tif (td.getAttribute('data-b-b-c')) border.bottom.color = { argb: td.getAttribute('data-b-t-c') };\r\n\t\t}\r\n\t\tif (td.getAttribute('data-b-r-s')) {\r\n\t\t\tborder.right.style = td.getAttribute('data-b-r-s');\r\n\t\t\tif (td.getAttribute('data-b-r-c')) border.right.color = { argb: td.getAttribute('data-b-t-c') };\r\n\t\t}\r\n\r\n\t\t//Fill\r\n\t\tlet fill;\r\n\t\tif (td.getAttribute('data-fill-color')) {\r\n\t\t\tfill = {\r\n\t\t\t\ttype: 'pattern',\r\n\t\t\t\tpattern: 'solid',\r\n\t\t\t\tfgColor: { argb: td.getAttribute('data-fill-color') },\r\n\t\t\t};\r\n\t\t}\r\n\t\t//number format\r\n\t\tlet numFmt;\r\n\t\tif (td.getAttribute('data-num-fmt')) numFmt = td.getAttribute('data-num-fmt');\r\n\r\n\t\treturn {\r\n\t\t\tfont,\r\n\t\t\talignment,\r\n\t\t\tborder,\r\n\t\t\tfill,\r\n\t\t\tnumFmt,\r\n\t\t};\r\n\t};\r\n\r\n\treturn methods;\r\n})();\r\n\r\nexport default TTEParser;\r\n"],"names":[],"version":3,"file":"tableToExcel.js.map"}